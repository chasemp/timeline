import"./hoisted.BScVxmeO.js";const M=document.getElementById("theme-toggle"),p=M?.querySelector(".theme-icon"),w=document.documentElement,T=localStorage.getItem("theme")||"light";w.setAttribute("data-theme",T);p&&(p.textContent=T==="dark"?"â˜€ï¸":"ðŸŒ™");M?.addEventListener("click",()=>{const t=w.getAttribute("data-theme")==="dark"?"light":"dark";w.setAttribute("data-theme",t),localStorage.setItem("theme",t),p&&(p.textContent=t==="dark"?"â˜€ï¸":"ðŸŒ™")});window.addEventListener("DOMContentLoaded",()=>{new window.PagefindUI({element:"#search-container",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"Search timeline..."}})});const r=new URLSearchParams(location.search),q=new Set((r.get("types")??"blog,saved,bluesky,release,wikipedia").split(",").filter(Boolean)),g=document.querySelectorAll('input[name="type"]');g.forEach(e=>{e.checked=q.has(e.value),e.addEventListener("change",E)});function E(){const e=Array.from(g).filter(t=>t.checked).map(t=>t.value);e.length===0?r.delete("types"):r.set("types",e.join(",")),history.replaceState({},"",r.toString()?`?${r.toString()}`:location.pathname),document.dispatchEvent(new CustomEvent("filters:changed",{detail:{types:e}}))}document.getElementById("select-all")?.addEventListener("click",()=>{g.forEach(e=>e.checked=!0),E()});document.getElementById("select-none")?.addEventListener("click",()=>{g.forEach(e=>e.checked=!1),E()});const m=new Set,H=document.querySelectorAll(".hashtag-pill");function P(){document.dispatchEvent(new CustomEvent("hashtag:changed",{detail:{hashtags:Array.from(m)}}))}H.forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.hashtag;m.has(t)?(m.delete(t),e.classList.remove("active")):(m.add(t),e.classList.add("active")),P()})});const I=new URLSearchParams(location.search),A=(I.get("types")??"").split(",").filter(Boolean);let h=new Set;function B(){const e=new Set(A.length?A:Array.from(document.querySelectorAll('input[name="type"]')).map(t=>t.value));document.querySelectorAll(".row").forEach(t=>{const n=t.dataset.type,o=t.dataset.hashtags?.split(",").filter(Boolean)||[],a=e.has(n),s=h.size===0||o.some(c=>h.has(c));t.style.display=a&&s?"":"none"})}B();document.addEventListener("filters:changed",e=>{const t=new Set(e.detail.types.length?e.detail.types:[]);document.querySelectorAll(".row").forEach(n=>{const o=n.dataset.type,a=n.dataset.hashtags?.split(",").filter(Boolean)||[],s=t.size===0?!1:t.has(o),c=h.size===0||a.some(f=>h.has(f));n.style.display=s&&c?"":"none"})});document.addEventListener("hashtag:changed",e=>{h=new Set(e.detail.hashtags),B()});const S=document.getElementById("detail-panel"),l=document.getElementById("panel-content"),x=document.getElementById("panel-title-text"),v=document.getElementById("panel-source-wrapper"),U=document.getElementById("panel-source"),u=document.getElementById("panel-close"),L=document.getElementById("panel-backdrop"),y=()=>window.innerWidth<=980;let d=l.innerHTML;(!d||d.trim()==="")&&(console.warn("Panel intro content is empty, attempting to restore..."),setTimeout(()=>{d=l.innerHTML},100));function $(e=!0){e&&y()?document.body.style.overflow="hidden":document.body.style.overflow=""}async function D(e){try{const n=await(await fetch(e)).text(),a=new DOMParser().parseFromString(n,"text/html"),s=a.querySelector("article")||a.querySelector("main")||a.querySelector(".content");return s?s.innerHTML:"<p>Unable to load content</p>"}catch{return"<p>Error loading content</p>"}}async function C(e){const t=window.__TIMELINE__.find(s=>s.id===e);if(!t)return;y()?(L.removeAttribute("hidden"),S.classList.add("mobile-open"),u.removeAttribute("hidden"),$(!0)):u.setAttribute("hidden","");const n=t.type==="saved"?"Article Read":t.type.toUpperCase();x.textContent=`${n} Â· ${new Date(t.timestamp).toLocaleString()}`,t.url?(U.href=t.url,v.removeAttribute("hidden")):v.setAttribute("hidden",""),l.innerHTML="<p>Loading...</p>";let o="";if(t.type==="blog"){const s=`/blog/${t.id.replace("blog:","")}`,c=await D(s);o=`<h3 class="detail-title">${t.title||""}</h3>
        <div class="detail-content">${c}</div>`}else o=`<h3 class="detail-title">${t.title||""}</h3>
        <div class="detail-content">${t.content_html||`<p>${t.summary||""}</p>`}</div>`;l.innerHTML=o;const a=new URLSearchParams(location.search);a.set("id",e),history.replaceState({},"",`?${a.toString()}`)}function b(){y()&&(L.setAttribute("hidden",""),S.classList.remove("mobile-open"),$(!1)),x.textContent="About",v.setAttribute("hidden",""),l.innerHTML=d,u.setAttribute("hidden","");const e=new URLSearchParams(location.search);e.delete("id"),history.replaceState({},"",`?${e.toString()}`)}u.addEventListener("click",b);L.addEventListener("click",b);document.addEventListener("keydown",e=>{e.key==="Escape"&&(y()?S.classList.contains("mobile-open"):l.innerHTML!==d)&&b()});document.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),C(e.dataset.id)})});const i=document.getElementById("tooltip"),R=i.querySelector(".tooltip-title"),F=i.querySelector(".tooltip-meta");function _(e){const n=Math.min(window.innerHeight-80,Math.max(0,e.top+window.scrollY+10)),o=Math.min(window.innerWidth-380,Math.max(0,e.left+window.scrollX+10));i.style.top=`${n}px`,i.style.left=`${o}px`}function N(e){const t=e.dataset.timestamp,n=e.dataset.dotType,o=new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),a={blog:"ðŸ“",saved:"ðŸ”–",bluesky:"ðŸ¦‹",release:"ðŸ·ï¸",wikipedia:"ðŸŒ"},s={saved:"Article Read"},c=a[n]||"",f=s[n]||n.toUpperCase();R.textContent=`${c} ${f}`,F.textContent=o,_(e.getBoundingClientRect()),i.removeAttribute("hidden")}function j(){i.setAttribute("hidden","")}document.querySelectorAll(".dot").forEach(e=>{const t=e;t.addEventListener("mouseenter",()=>N(t)),t.addEventListener("mouseleave",j)});const k=I.get("id");k&&C(k);
