import"./hoisted.BScVxmeO.js";const C=document.getElementById("theme-toggle"),p=C?.querySelector(".theme-icon"),b=document.documentElement,q=localStorage.getItem("theme")||"light";b.setAttribute("data-theme",q);p&&(p.textContent=q==="dark"?"â˜€ï¸":"ðŸŒ™");C?.addEventListener("click",()=>{const t=b.getAttribute("data-theme")==="dark"?"light":"dark";b.setAttribute("data-theme",t),localStorage.setItem("theme",t),p&&(p.textContent=t==="dark"?"â˜€ï¸":"ðŸŒ™")});window.addEventListener("DOMContentLoaded",()=>{new window.PagefindUI({element:"#search-container",showSubResults:!0,showImages:!1,excerptLength:15,translations:{placeholder:"Search timeline..."}})});const h=new URLSearchParams(location.search),j=new Set((h.get("types")??"blog,saved,bluesky,release,wikipedia").split(",").filter(Boolean)),f=document.querySelectorAll('input[name="type"]');f.forEach(e=>{e.checked=j.has(e.value),e.addEventListener("change",A)});function A(){const e=Array.from(f).filter(t=>t.checked).map(t=>t.value);e.length===0?h.delete("types"):h.set("types",e.join(",")),history.replaceState({},"",h.toString()?`?${h.toString()}`:location.pathname),document.dispatchEvent(new CustomEvent("filters:changed",{detail:{types:e}}))}const r=new Set,c=document.getElementById("hashtag-dropdown-btn"),g=document.getElementById("hashtag-dropdown-menu"),v=document.getElementById("selected-hashtag-count"),D=document.querySelectorAll('.hashtag-option input[type="checkbox"]');document.getElementById("select-all")?.addEventListener("click",()=>{f.forEach(e=>e.checked=!0),A()});document.getElementById("select-none")?.addEventListener("click",()=>{f.forEach(t=>t.checked=!1),D.forEach(t=>t.checked=!1),r.clear(),H();const e=document.querySelector(".pagefind-ui__search-input");e&&(e.value="",e.dispatchEvent(new Event("input",{bubbles:!0}))),A()});function H(){document.dispatchEvent(new CustomEvent("hashtag:changed",{detail:{hashtags:Array.from(r)}})),r.size>0?(v.textContent=r.size.toString(),v.removeAttribute("hidden")):v.setAttribute("hidden","")}c?.addEventListener("click",e=>{e.stopPropagation(),c.getAttribute("aria-expanded")==="true"?(g?.setAttribute("hidden",""),c.setAttribute("aria-expanded","false")):(g?.removeAttribute("hidden"),c.setAttribute("aria-expanded","true"))});D.forEach(e=>{e.addEventListener("change",()=>{const t=e.dataset.hashtag;e.checked?r.add(t):r.delete(t),H()})});document.addEventListener("click",e=>{!c?.contains(e.target)&&!g?.contains(e.target)&&(g?.setAttribute("hidden",""),c?.setAttribute("aria-expanded","false"))});const P=new URLSearchParams(location.search),B=(P.get("types")??"").split(",").filter(Boolean);let u=new Set;const x=document.getElementById("empty-state"),M=document.querySelector(".list"),T=document.getElementById("current-date"),N=document.getElementById("reset-machine");T&&(T.textContent=new Date().toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"}));N?.addEventListener("click",e=>{e.preventDefault(),window.location.href=window.location.pathname});function U(){Array.from(document.querySelectorAll(".row:not(.today-marker)")).filter(t=>t.style.display!=="none").length===0?(x?.removeAttribute("hidden"),M?.setAttribute("hidden","")):(x?.setAttribute("hidden",""),M?.removeAttribute("hidden"))}function _(){const e=new Set(B.length?B:Array.from(document.querySelectorAll('input[name="type"]')).map(t=>t.value));document.querySelectorAll(".row").forEach(t=>{const n=t.dataset.type,s=t.dataset.hashtags?.split(",").filter(Boolean)||[],i=e.has(n),a=u.size===0||s.some(o=>u.has(o));t.style.display=i&&a?"":"none"}),U()}_();document.addEventListener("filters:changed",e=>{const t=new Set(e.detail.types.length?e.detail.types:[]);document.querySelectorAll(".row").forEach(n=>{const s=n.dataset.type,i=n.dataset.hashtags?.split(",").filter(Boolean)||[],a=t.size===0?!1:t.has(s),o=u.size===0||i.some(E=>u.has(E));n.style.display=a&&o?"":"none"}),U()});document.addEventListener("hashtag:changed",e=>{u=new Set(e.detail.hashtags),_()});const L=document.getElementById("detail-panel"),d=document.getElementById("panel-content"),R=document.getElementById("panel-title-text"),S=document.getElementById("panel-source-wrapper"),W=document.getElementById("panel-source"),y=document.getElementById("panel-close"),k=document.getElementById("panel-backdrop"),w=()=>window.innerWidth<=980;let m=d.innerHTML;(!m||m.trim()==="")&&(console.warn("Panel intro content is empty, attempting to restore..."),setTimeout(()=>{m=d.innerHTML},100));function z(e=!0){e&&w()?document.body.style.overflow="hidden":document.body.style.overflow=""}async function O(e){try{const n=await(await fetch(e)).text(),i=new DOMParser().parseFromString(n,"text/html"),a=i.querySelector("article")||i.querySelector("main")||i.querySelector(".content");return a?a.innerHTML:"<p>Unable to load content</p>"}catch{return"<p>Error loading content</p>"}}async function F(e){const t=window.__TIMELINE__.find(a=>a.id===e);if(!t)return;w()?(k.removeAttribute("hidden"),L.classList.add("mobile-open"),y.removeAttribute("hidden"),z(!0)):y.setAttribute("hidden","");const n=t.type==="saved"?"Article Read":t.type.toUpperCase();R.textContent=`${n} Â· ${new Date(t.timestamp).toLocaleString()}`,t.url?(W.href=t.url,S.removeAttribute("hidden")):S.setAttribute("hidden",""),d.innerHTML="<p>Loading...</p>";let s="";if(t.type==="blog"){const a=`/blog/${t.id.replace("blog:","")}`,o=await O(a);s=`<h3 class="detail-title">${t.title||""}</h3>
        <div class="detail-content">${o}</div>`}else{let a="";if(t.type==="saved"){const o=[];t.metadata?.site_name&&o.push(`ðŸ“° ${t.metadata.site_name}`),t.author&&o.push(`âœï¸ ${t.author}`),t.metadata?.reading_time&&o.push(`â±ï¸ ${t.metadata.reading_time}`),o.length>0&&(a=`<div class="detail-metadata">${o.join(" â€¢ ")}</div>`)}s=`<h3 class="detail-title">${t.title||""}</h3>
        ${a}
        <div class="detail-content">${t.content_html||`<p>${t.summary||""}</p>`}</div>`}d.innerHTML=s;const i=new URLSearchParams(location.search);i.set("id",e),history.replaceState({},"",`?${i.toString()}`)}function I(){w()&&(k.setAttribute("hidden",""),L.classList.remove("mobile-open"),z(!1)),R.textContent="About",S.setAttribute("hidden",""),d.innerHTML=m,y.setAttribute("hidden","");const e=new URLSearchParams(location.search);e.delete("id"),history.replaceState({},"",`?${e.toString()}`)}y.addEventListener("click",I);k.addEventListener("click",I);document.addEventListener("keydown",e=>{e.key==="Escape"&&(w()?L.classList.contains("mobile-open"):d.innerHTML!==m)&&I()});document.querySelectorAll(".card").forEach(e=>{e.addEventListener("click",t=>{t.preventDefault(),F(e.dataset.id)})});const l=document.getElementById("tooltip"),X=l.querySelector(".tooltip-title"),Y=l.querySelector(".tooltip-meta");function G(e){const n=Math.min(window.innerHeight-80,Math.max(0,e.top+window.scrollY+10)),s=Math.min(window.innerWidth-380,Math.max(0,e.left+window.scrollX+10));l.style.top=`${n}px`,l.style.left=`${s}px`}function J(e){const t=e.dataset.timestamp,n=e.dataset.dotType,s=new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}),i={blog:"ðŸ“",saved:"ðŸ”–",bluesky:"ðŸ¦‹",release:"ðŸ·ï¸",wikipedia:"ðŸŒ"},a={saved:"Article Read"},o=i[n]||"",E=a[n]||n.toUpperCase();X.textContent=`${o} ${E}`,Y.textContent=s,G(e.getBoundingClientRect()),l.removeAttribute("hidden")}function K(){l.setAttribute("hidden","")}document.querySelectorAll(".dot").forEach(e=>{const t=e;t.addEventListener("mouseenter",()=>J(t)),t.addEventListener("mouseleave",K)});const $=P.get("id");$&&F($);
